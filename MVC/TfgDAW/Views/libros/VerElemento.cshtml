@model IEnumerable<TfgDAW.Models.Libros>

    <!DOCTYPE html>
    <html>
    <head>

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="~/Content/css/verelemento.css">
        <script src="~/Content/js/scripts.js" defer></script>
        @*Visor de pdf PDF.js*@
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js"></script>
    </head>
    <body>
        <!-- Menu -->
        <div id="menu">
            <div id="contenidoMenu">
                <a href="@Url.Action("Index", "Libros")">Inicio</a>
                <div class="linea"></div>
                <a href="@Url.Action("MisElementos", "Libros")">MisElementos</a>
                <div class="linea"></div>
                <p>Grupos</p>
                <div class="linea"></div>
                <a href="@Url.Action("Favoritos", "Libros")">Favoritos</a>
                <div class="linea"></div><p>CVs</p>
            </div>
        </div>
        <!-- Nav -->
        <nav>
            <ul>
                <li id="liVerMenu">
                    <input id="verMenu" type="checkbox">
                    <label id="verMenuLabel" for="verMenu">
                        <div class="verMenuDiv">
                            <div class="linea1"></div>
                            <div class="linea2"></div>
                            <div class="linea3"></div>
                        </div>
                    </label>
                </li>
                <li id="liVerMenuCuenta">
                    <input type="checkbox" id="verMenuCuenta">
                    <label id="verMenuCuentaLabel" for="verMenuCuenta">
                        <img class="cuentaImg" src="~/Content/imgs/iconocuenta.png" />
                        <div class="cuentaClose">
                            <div class="linea1"></div>
                            <div class="linea2"></div>
                        </div>
                    </label>
                </li>
            </ul>
        </nav>
        <!-- Menu de cuenta -->
        <div id="menuCuenta">
            <div id="contenidoMenuCuenta">
                <p>Nombres</p>
                <div class="linea"></div>
                <a href="@Url.Action("MisDatos", "Usuarios")">Mis datos</a>
                <div class="linea"></div>
                <p>Cerrar sesion</p>
            </div>
        </div>
        <!-- main -->
        <main>

            <!-- contenido -->
            <div class="contenido">
                @foreach (var item in Model)
                {

                    ViewBag.Title = @Html.DisplayFor(modelItem => item.titulo);

                    <div class="izquierda">
                        @if (item.portada != null && item.portada.Length > 0)
                        {
                            <img class="portada" src="data:image;base64,@Convert.ToBase64String(item.portada)" />
                        }
                        else
                        {
                            <img class="portada" src="~/Content/imgs/imgpordefecto.jpg" />
                        }

                        <a class="descarga" href="@Url.Action("DescargarArchivo", "Libros", new { id = item.libro_id })">Descargar</a>

                    </div>
                    <div class="derecha">
                        <p class="nombre">@Html.DisplayFor(modelItem => item.titulo)</p>
                        <p class="autor">@Html.DisplayFor(modelItem => item.autor)</p>
                        <p class="descripcion">@Html.DisplayFor(modelItem => item.descripcion)</p>
                    </div>
                    @*Ver archivo*@
                    <div id="pdf-viewer"></div>
                    <script>
const url = '@Url.Action("VerArchivo", "Libros", new { id = item.libro_id })';

const pdfjsLib = window['pdfjs-dist/build/pdf'];
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.worker.min.js';

const loadingTask = pdfjsLib.getDocument(url);
loadingTask.promise.then(function(pdf) {
    const viewer = document.getElementById('pdf-viewer');

    for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
        pdf.getPage(pageNum).then(function(page) {
            const scale = 1.5;
            const viewport = page.getViewport({ scale: scale });

            const canvas = document.createElement('canvas');
            canvas.className = 'pdf-page';
            viewer.appendChild(canvas);

            const context = canvas.getContext('2d');
            canvas.height = viewport.height;
            canvas.width = viewport.width;

            const renderContext = {
                canvasContext: context,
                viewport: viewport
            };
            page.render(renderContext);
        });
    }
});
                    </script>
                }
            </div>
        </main>
    </body>
</html>
